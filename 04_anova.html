<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANOVA Interactive Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            min-width: 120px;
        }

        .nav-tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
        }

        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .concept-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .formula-box {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .example-box {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .warning-box {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-left: 5px solid #e74c3c;
        }

        .quiz-container {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .quiz-question {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .quiz-options {
            list-style: none;
            padding: 0;
        }

        .quiz-options li {
            background: rgba(255, 255, 255, 0.8);
            margin: 10px 0;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-options li:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateX(5px);
        }

        .quiz-options li.correct {
            background: #4CAF50;
            color: white;
        }

        .quiz-options li.incorrect {
            background: #f44336;
            color: white;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            display: none;
        }

        .steps-container {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .step {
            background: rgba(255, 255, 255, 0.9);
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .step-number {
            background: #667eea;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .anova-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-family: 'Courier New', monospace;
        }

        .anova-table th {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 12px;
            text-align: center;
            font-size: 0.9em;
        }

        .anova-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .demo-controls {
            margin: 15px 0;
        }

        .demo-controls input {
            margin: 5px;
            padding: 8px;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.9);
        }

        .demo-button {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .demo-button:hover {
            background: white;
            color: #667eea;
        }

        .result-display {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            backdrop-filter: blur(5px);
        }

        .apa-example {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-family: 'Times New Roman', serif;
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        h3 {
            color: #764ba2;
            margin: 15px 0 10px 0;
            font-size: 1.4em;
        }

        .highlight {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .variance-visual {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .variance-group {
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            min-width: 200px;
        }

        .score-counter {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 10px;
            color: #667eea;
        }

        .quiz-score {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            padding: 10px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-weight: bold;
            color: #667eea;
        }

        .interpretation-guide {
            background: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                flex: none;
            }
            
            .variance-visual {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quiz-score" id="quizScore">Điểm: 0/12</div>
        
        <div class="header">
            <h1>🧮 ANOVA: Phân tích phương sai</h1>
            <p>Học cách áp dụng ANOVA một chiều và hai chiều trong nghiên cứu với Jamovi</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('concepts')">Khái niệm phương sai</button>
            <button class="nav-tab" onclick="showSection('oneway')">One-way ANOVA</button>
            <button class="nav-tab" onclick="showSection('twoway')">Two-way ANOVA</button>
            <button class="nav-tab" onclick="showSection('jamovi')">Thực hành Jamovi</button>
            <button class="nav-tab" onclick="showSection('apa')">Báo cáo APA</button>
            <button class="nav-tab" onclick="showSection('quiz')">Bài tập (12 câu)</button>
        </div>

        <!-- Khái niệm phương sai -->
        <div id="concepts" class="content-section active">
            <h2>📊 Hiểu về Phương sai trong ANOVA</h2>
            
            <div class="concept-box">
                <h3>🎯 ANOVA là gì?</h3>
                <p><strong>ANOVA (Analysis of Variance)</strong> - Phân tích phương sai là phương pháp thống kê dùng để so sánh giá trị trung bình của hai nhóm trở lên để xem có sự khác biệt nào không. Được coi là phần mở rộng của t-test.</p>
            </div>

            <h3>🔍 Logic cốt lõi của ANOVA</h3>
            <div class="formula-box">
                <h4>Công thức F-statistic</h4>
                <div style="font-size: 1.5em; margin: 15px 0;">
                    F = <span style="text-decoration: overline;">Between group variance</span> / <span style="text-decoration: overline;">Within group variance</span>
                </div>
                <div style="font-size: 1.2em; margin: 15px 0;">
                    F = MS<sub>treatment</sub> / MS<sub>error</sub> = (SS<sub>treatment</sub>/df<sub>treatment</sub>) / (SS<sub>error</sub>/df<sub>error</sub>)
                </div>
            </div>

            <h3>📈 Hai loại phương sai quan trọng</h3>
            <div class="variance-visual">
                <div class="variance-group">
                    <h4>🔄 Within-group variance</h4>
                    <p><strong>Phương sai trong nhóm</strong></p>
                    <p>Sự chênh lệch trung bình giữa mỗi điểm giá trị và trung bình cộng của nhóm đó</p>
                    <p style="font-style: italic; color: #666;">Phản ánh sự biến thiên tự nhiên</p>
                </div>
                <div class="variance-group">
                    <h4>📊 Between-group variance</h4>
                    <p><strong>Phương sai giữa các nhóm</strong></p>
                    <p>Sự chênh lệch trung bình giữa TBC của từng nhóm và TBC chung (grand mean)</p>
                    <p style="font-style: italic; color: #666;">Phản ánh ảnh hưởng của treatment</p>
                </div>
            </div>

            <div class="warning-box">
                <h4>⚠️ Ý nghĩa của F-statistic</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Nếu F lớn:</strong> Between-group variance >> Within-group variance → có khả năng bác bỏ H₀ → có sự khác biệt giữa các nhóm</li>
                    <li><strong>Khi H₀ đúng:</strong> F có giá trị xấp xỉ 1 (không có sự khác biệt thực sự)</li>
                    <li><strong>Quy tắc quyết định:</strong> Nếu giá trị thu được của F ≥ giá trị quyết định (thường α = 0.05) → bác bỏ H₀</li>
                </ul>
            </div>

            <h3>🧮 Bảng ANOVA và các thành phần</h3>
            <table class="anova-table">
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Sum of Squares (SS)</th>
                        <th>df</th>
                        <th>Mean Square (MS)</th>
                        <th>F</th>
                        <th>p</th>
                        <th>η²</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Treatment</strong></td>
                        <td>SS<sub>treatment</sub></td>
                        <td>k - 1</td>
                        <td>SS<sub>treatment</sub>/df<sub>treatment</sub></td>
                        <td rowspan="2">MS<sub>treatment</sub>/MS<sub>error</sub></td>
                        <td rowspan="2">< .05 ?</td>
                        <td rowspan="2">SS<sub>treatment</sub>/SS<sub>total</sub></td>
                    </tr>
                    <tr>
                        <td><strong>Error</strong></td>
                        <td>SS<sub>error</sub></td>
                        <td>N - k</td>
                        <td>SS<sub>error</sub>/df<sub>error</sub></td>
                    </tr>
                    <tr>
                        <td><strong>Total</strong></td>
                        <td>SS<sub>total</sub></td>
                        <td>N - 1</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-box">
                <h4>📝 Giải thích các thành phần:</h4>
                <ul style="padding-left: 20px;">
                    <li><strong>SS (Sum of Squares):</strong> Tổng bình phương độ lệch</li>
                    <li><strong>df (degrees of freedom):</strong> Bậc tự do</li>
                    <li><strong>MS (Mean Square):</strong> Phương sai = SS/df</li>
                    <li><strong>k:</strong> Số nhóm/levels</li>
                    <li><strong>N:</strong> Tổng số quan sát</li>
                    <li><strong>η² (eta squared):</strong> Effect size - tỷ lệ phương sai được giải thích</li>
                </ul>
            </div>

            <h3>🔧 Giả định quan trọng</h3>
            <div class="steps-container">
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>Độc lập quan sát:</strong> Các quan sát độc lập với nhau
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>Phân phối chuẩn:</strong> Dữ liệu phân phối chuẩn trong mỗi nhóm
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Đồng nhất phương sai:</strong> σ²₁ = σ²₂ = σ²₃... (Homogeneity of Variance)
                </div>
            </div>

            <div class="interactive-demo">
                <h3>🎮 Demo: Tính F-statistic thực tế</h3>
                <div class="demo-controls">
                    <label>Nhóm 1 (M): <input type="number" id="mean1" value="10" step="0.1"></label>
                    <label>Nhóm 2 (M): <input type="number" id="mean2" value="12" step="0.1"></label>
                    <label>Nhóm 3 (M): <input type="number" id="mean3" value="15" step="0.1"></label><br>
                    <label>Phương sai trong nhóm: <input type="number" id="withinVar" value="4" step="0.1"></label>
                    <button class="demo-button" onclick="calculateF()">Tính F-statistic</button>
                </div>
                <div class="result-display" id="fResult"></div>
            </div>
        </div>

        <!-- One-way ANOVA -->
        <div id="oneway" class="content-section">
            <h2>📊 One-way ANOVA</h2>

            <div class="concept-box">
                <h3>🎯 Khi nào sử dụng One-way ANOVA?</h3>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Có <strong>1 biến độc lập</strong> với 3 hoặc nhiều nhóm/levels</li>
                    <li>Có <strong>1 biến phụ thuộc</strong> liên tục</li>
                    <li>Muốn kiểm tra xem các nhóm có khác biệt đáng kể không</li>
                </ul>
            </div>

            <h3>📋 Giả thuyết trong One-way ANOVA</h3>
            <div class="formula-box">
                <div style="text-align: left; font-size: 1.1em;">
                    <p><strong>H₀:</strong> μ₁ = μ₂ = μ₃ = ... = μₖ</p>
                    <p style="margin: 10px 0;">KHÔNG có sự khác biệt giữa các nhóm trung bình</p>
                    <p><strong>H₁:</strong> Ít nhất một nhóm khác biệt đáng kể</p>
                    <p style="margin: 10px 0;">Có sự khác biệt (có ý nghĩa thống kê)</p>
                </div>
            </div>

            <h3>🔍 Post-hoc Tests (Hậu phân tích)</h3>
            <div class="warning-box">
                <h4>⚠️ Tại sao cần Post-hoc?</h4>
                <p>Kết quả ANOVA chỉ cho biết có sự khác biệt đáng kể giữa các nhóm hay không. Nhưng <strong>KHÔNG cho biết nhóm nào khác nhóm nào!</strong> (vì H₁ của ta là có sự khác biệt, chứ không rõ khác biệt ở đâu)</p>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Post-hoc Test</th>
                        <th>Khi nào sử dụng</th>
                        <th>Ưu điểm</th>
                        <th>Nhược điểm</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="highlight">Tukey HSD</span></td>
                        <td>Phương sai đồng nhất</td>
                        <td>Cân bằng Type I và Type II error</td>
                        <td>Cần giả định đồng nhất phương sai</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">Games-Howell</span></td>
                        <td>Phương sai KHÔNG đồng nhất</td>
                        <td>Không cần giả định đồng nhất</td>
                        <td>Ít powerful hơn Tukey</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">Bonferroni</span></td>
                        <td>Kiểm soát chặt chẽ Type I error</td>
                        <td>Rất conservative</td>
                        <td>Dễ bỏ sót sự khác biệt thực</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-box">
                <h3>💡 Ví dụ thực tế: So sánh điểm thi của 3 trường</h3>
                <p><strong>Biến độc lập:</strong> Trường học (A, B, C)</p>
                <p><strong>Biến phụ thuộc:</strong> Điểm thi toán</p>
                <p><strong>Kết quả giả định:</strong> F(2, 87) = 12.45, p < .001, η² = .22</p>
                <p><strong>Giải thích:</strong> Có sự khác biệt có ý nghĩa thống kê giữa các trường (p < .001), với 22% phương sai được giải thích bởi yếu tố trường học.</p>
            </div>
        </div>

        <!-- Two-way ANOVA -->
        <div id="twoway" class="content-section">
            <h2>📈 Two-way ANOVA</h2>

            <div class="concept-box">
                <h3>🎯 Ưu thế của Two-way ANOVA</h3>
                <p>Two-way ANOVA cho phép nghiên cứu <strong>2 biến độc lập</strong> cùng lúc và kiểm tra:</p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Main Effect A:</strong> Ảnh hưởng của biến độc lập A (bỏ qua biến B)</li>
                    <li><strong>Main Effect B:</strong> Ảnh hưởng của biến độc lập B (bỏ qua biến A)</li>
                    <li><strong>Interaction Effect A×B:</strong> Ảnh hưởng kết hợp của A và B</li>
                </ul>
            </div>

            <h3>⚡ Hiểu về Interaction Effect</h3>
            <div class="interpretation-guide">
                <h4>🔍 Interaction Effect có ý nghĩa khi nào?</h4>
                <p><strong>Có interaction:</strong> Hiệu ứng của biến A phụ thuộc vào level của biến B (hoặc ngược lại)</p>
                <p><strong>Không có interaction:</strong> Hiệu ứng của biến A giống nhau ở tất cả levels của biến B</p>
                
                <div style="margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.8); border-radius: 8px; color: #333;">
                    <strong>Ví dụ có interaction:</strong><br>
                    • Phương pháp dạy hiện đại có hiệu quả với nam sinh (+10 điểm)<br>
                    • Nhưng không có hiệu quả với nữ sinh (0 điểm)<br>
                    → <em>Hiệu ứng của phương pháp dạy phụ thuộc vào giới tính</em>
                </div>
            </div